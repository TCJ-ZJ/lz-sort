(function(e){var b="lz-sort"+new Date().getTime();e.extend({isArray:function(f){return Object.prototype.toString.call(f)==="[object Array]";},isObject:function(f){return Object.prototype.toString.call(f)==="[object Object]";
},checkkit:function(){var h=false,g=new RegExp("IE"),f=(function(){var j=navigator.userAgent,i,k=j.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];
if(/trident/i.test(k[1])){i=/\brv[ :]+(\d+)/g.exec(j)||[];return["IE ",(i[1]||"")];}if(k[1]==="Chrome"){i=j.match(/\b(OPR|Edge)\/(\d+)/);if(i!=null){return i.slice(1);
}}k=k[2]?[k[1],k[2]]:[navigator.appName,navigator.appVersion,"-?"];if((i=j.match(/version\/(\d+)/i))!=null){k.splice(1,1,i[1]);}return k;})();if(g.test(f[0])){+f[1]<11&&(h=true);
}else{if(f[0]=="Chrome"){+f[1]<43&&(h=true);}else{if(f[0]=="Firefox"){+f[1]<43&&(h=true);}else{if(f[0]=="OPR"){+f[1]<40&&(h=true);}else{if(f[0]=="Safari"){+f[1]<8&&(h=true);
}}}}}return h;}});sortEvent=function(f){this.$ele=e(f);this.param=this.$ele.data("lzsort-param");this.status=this.$ele.data("lzsort-status");};sortEvent.prototype.setEvent=function(){var f=this,g=this.param;
if(e.isArray(g.event)){e.each(g.event,function(h,i){f[i]&&f[i]();});}else{f[g.event]&&f[g.event]();}};sortEvent.prototype.drag=function(){var h=this.$ele,g=h.get(0),f=this.status,i=this.param;
h.children().off(".lzsort").on("mousedown.lzsort",function(j){if(j.button==0){j.preventDefault();j.stopPropagation();f.mousex=j.pageX;f.mousey=j.pageY;
f.beforePos=e(this).index();f.afterPos=e(this).index();f.elem=e(this);f.posx=e(this).position().left;f.posy=e(this).position().top;g.sortexcute.setBlock(e(this));
e(this).css("opacity",i.opacity);f.dragFlag=true;i._onDragStart&&i._onDragStart.call(this,i,f);}});h.off(".lzsort").on("mousemove.lzsort",function(q){q.preventDefault();
q.stopPropagation();if((f.myflag||f.longflag)&&f.dragFlag){var p=null,j=q.pageX-f.mousex+f.posx,r=q.pageY-f.mousey+f.posy;f.block.css({top:r,left:j});if(f.kit){f.block.hide();
p=document.elementFromPoint(q.clientX,q.clientY);f.block.show();}else{p=q.target;}if(e(p).hasClass(b)&&e(p).index()!==f.afterPos&&!f.onprogress){f.onprogress=true;
var o=f.elem.get(0).getBoundingClientRect(),n=p.getBoundingClientRect(),m=e(p).index();var l=g.sortexcute.doMove(p);l&&(f.afterPos=m);if(i.animation&&!f.kit&&l){g.sortexcute.doEffect(o,f.elem.get(0));
g.sortexcute.doEffect(n,p);}else{f.onprogress=false;}}i._onDrag&&i._onDrag.call(this,i,f);}});e(document).on("mouseup",function(j){j.preventDefault();if(f.block){f.dragFlag=false;
f.block.remove();f.block=null;f.elem.css("opacity",1);!f.myflag&&f.elem.css("cursor","default");g.sortexcute.setaffiliates();i._onDragEnd&&i._onDragEnd.call(this,i,f);
}});};sortEvent.prototype.wheel=function(){var h=this.$ele,g=h.get(0),f=this.status,i=this.param;h.children().off("mousewheel.lzsort DOMMouseScroll.lzsort").on("mousewheel.lzsort DOMMouseScroll.lzsort",function(n){n.preventDefault();
n.stopPropagation();if(f.myflag&&!f.dragFlag&&!f.onprogress&&i.wheel){var m=null;f.onprogress=true;f.beforePos=e(this).index();f.afterPos=e(this).index();
f.elem=e(this);var o=(n.originalEvent.wheelDelta&&(n.originalEvent.wheelDelta>0?1:-1))||(n.originalEvent.detail&&(n.originalEvent.detail>0?-1:1));if(o>0){m=e(n.target).prev();
}else{if(o<0){m=e(n.target).next();}}if(m.length!=0){var l=f.elem.get(0).getBoundingClientRect(),k=m.get(0).getBoundingClientRect(),j=e(m).index();if(j>f.afterPos){e(m).after(f.elem);
}else{if(j<f.afterPos){e(m).before(f.elem);}}f.afterPos=j;if(i.animation&&!f.kit){g.sortexcute.doEffect(l,f.elem.get(0));g.sortexcute.doEffect(k,m.get(0));
}else{f.onprogress=false;}g.sortexcute.setaffiliates();}else{f.onprogress=false;}}});};sortEvent.prototype.longPress=function(){var i=this.$ele,h=i.get(0),f=this.status,j=this.param,g=null;
i.children().off(".longPress").on("mousedown.longPress",function(l){var k=e(this);if(l.button===0&&j.longPress){g=setTimeout(function(){f.longflag=true;
k.css("cursor","move");(!j.myflag&&j._onDragStart)&&j._onDragStart.call(this,j,f);},1000);}}).on("mouseout.longPress",function(k){k.preventDefault();if(f.longflag!=true){clearInterval(g);
g=null;}});e(document).on("mouseup",function(k){k.preventDefault();if(g){clearInterval(g);g=null;}f.longflag=false;});};var a=function(f){this.$ele=e(f),this.param=this.$ele.data("lzsort-param");
this.status=this.$ele.data("lzsort-status");};a.prototype.setBlock=function(h){var g=this.$ele,j=this.param,f=this.status,i=e(h).clone();i.css({position:"absolute",top:e(h).position().top,left:e(h).position().left,"pointer-events":"none"}).addClass("lzsort-helper").removeClass(b).appendTo(g);
f.block=e(".lzsort-helper").eq(0);};a.prototype.doMove=function(i){var h=this.$ele,f=this.status,j=this.param;var g=e(i).index();if(j.axis==="y"){if(g>f.afterPos&&e(i).offset().left===f.elem.offset().left){e(i).after(f.elem);
return true;}else{if(g<f.afterPos&&e(i).offset().left===f.elem.offset().left){e(i).before(f.elem);return true;}}}else{if(j.axis==="x"){if(g>f.afterPos&&e(i).offset().top===f.elem.offset().top){e(i).after(f.elem);
return true;}else{if(g<f.afterPos&&e(i).offset().top===f.elem.offset().top){e(i).before(f.elem);return true;}}}else{if(g>f.afterPos){e(i).after(f.elem);
return true;}else{if(g<f.afterPos){e(i).before(f.elem);return true;}}}}return false;};a.prototype.doEffect=function(i,h){var g=this.$ele,f=this.status,k=this.param;
var j=h.getBoundingClientRect();e(h).css({transition:"none",transform:"translate("+(i.left-j.left)+"px,"+(i.top-j.top)+"px)"});h.offsetWidth;e(h).css("transition","all "+k.duration+"ms "+k.effect);
e(h).css("transform","translate(0,0)");clearTimeout(h.animated);h.animated=setTimeout(function(){e(h).css({transition:"",transform:""});f.onprogress=false;
h.animated=null;},k.duration);};a.prototype.setaffiliates=function(){var h=this.status,g=h.afterPos,f=h.beforePos;e.each(e(h.affiliates),function(i,j){if(f>g){e(j).children().eq(g).before(e(j).children().eq(f));
}else{if(f<g){e(j).children().eq(g).after(e(j).children().eq(f));}}});};var c=function(g,f){this.$ele=e(g);this.$ele.data("lzsort-param",this.initParam(f));
this.$ele.data("lzsort-status",{block:null,dragFlag:false,elem:null,beforePos:0,afterPos:0,affiliates:"",posx:0,posy:0,mousex:0,mousey:0,kit:false,onprogress:false,myflag:false,longflag:false});
};c.prototype.layout=function(){var g=this.$ele,h=g.data("lzsort-param"),f=g.data("lzsort-status");f.kit=e.checkkit();if(g.css("position")==="static"){g.css("position","relative");
}f.affiliates=h.affiliates.join(",");g.children().addClass(b);};c.prototype.initEvent=function(){var g=this.$ele,h=g.data("lzsort-param"),f=new sortEvent(g);
if(h.wheel){h.event.push("wheel");}if(h.longPress){h.event.push("longPress");}f.setEvent();};c.prototype.initParam=function(f){var g={axis:"xy",opacity:0,animation:true,effect:"ease",duration:100,affiliates:[],wheel:false,longPress:false,_onDragStart:null,_onDrag:null,_onDragEnd:null,event:["drag","wheel","longPress"]};
e.isArray(f)&&(g.affiliates=f);typeof f==="string"&&(g.axis=f);typeof f==="boolean"&&(g.animation=f);e.isObject(f)&&(g=e.extend({},g,this.$ele.data("lzsort-param")));
g.axis=(g.axis=="x"||g.axis=="y"||g.axis=="xy"||g.axis=="yx")?g.axis:"xy";g.animation=(g.animation===false)?false:true;isNaN(g.delay)&&(g.delay=0);isNaN(g.duration)&&(g.duration=300);
isNaN(g.opacity)&&(g.opacity=0);g.wheel=(g.wheel===true)?true:false;g.longPress=(g.longPress===true)?true:false;return g;};var d=function(f){this.$ele=e(f);
};d.prototype.destory=function(){var f=this.$ele;e.each(f,function(h,i){var g=e(i);g.off(".lzsort");g.children().off(".lzsort").off(".longPress");g.removeData("lzsort-param").removeData("lzsort-status");
});return false;};d.prototype.init=function(f){var g=this.$ele;e.each(g,function(i,j){var h=e(j);h.off(".lzsort");h.children().off(".lzsort").off(".longPress");
h.removeData("lzsort-param").removeData("lzsort-status");});g.lzsort(f);};d.prototype.setAxis=function(g){var f=this.$ele;e.each(f,function(h,i){e(i).data("lzsort-param").axis=g;
});return this;};d.prototype.setOpacity=function(f){var g=this.$ele;e.each(g,function(h,i){e(i).data("lzsort-param").opacity=f;});};d.prototype.setDuration=function(f){var g=this.$ele;
e.each(g,function(h,i){e(i).data("lzsort-param").duration=f;});};d.prototype.setAffiliates=function(f){var g=this.$ele;e.each(g,function(h,i){e(i).data("lzsort-param").affiliates=f;
e(i).data("lzsort-status").affiliates=f.join(",");});};d.prototype.start=function(){var f=this.$ele;e.each(f,function(g,h){e(h).data("lzsort-status").myflag=true;
});f.children().css("cursor","move");};d.prototype.stop=function(){var f=this.$ele;e.each(f,function(g,h){e(h).data("lzsort-status").myflag=false;});f.children().css("cursor","default");
};d.prototype.onAnimation=function(){var f=this.$ele;e.each(f,function(g,h){e(h).data("lzsort-param").animation=true;});};d.prototype.offAnimation=function(){var f=this.$ele;
e.each(f,function(g,h){e(h).data("lzsort-param").animation=false;});};d.prototype.onWheel=function(){var f=this.$ele;e.each(f,function(g,h){e(h).data("lzsort-param").wheel=true;
});};d.prototype.offWheel=function(){var f=this.$ele;e.each(f,function(g,h){e(h).data("lzsort-param").wheel=false;});};d.prototype.onLongPress=function(){var f=this.$ele;
e.each(f,function(g,h){e(h).data("lzsort-param").longPress=true;});};d.prototype.offLongPress=function(){var f=this.$ele;e.each(f,function(g,h){e(h).data("lzsort-param").longPress=false;
});};d.prototype.on=function(g,f){if((g==="dragStart"||g==="drag"||g==="dragEnd")&&typeof f==="function"){e.each(me,function(h,i){g==="dragStart"&&(e(i).data("lzsort-param")._onDragStart=f);
g==="drag"&&(e(i).data("lzsort-param")._onDrag=f);g==="dragEnd"&&(e(i).data("lzsort-param")._onDragEnd=f);});}};e.fn.sortTool=function(){var f=e(this);
return new d(f);};e.fn.lzsort=function(f){var g=e(this);e.each(g,function(i,j){var h=new c(j,f);j.sortexcute=new a(j);h.layout();h.initEvent();});return g.sortTool();
};})(jQuery);